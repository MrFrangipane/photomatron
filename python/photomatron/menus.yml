start_with: idle
menus:
  idle:
    caption:
      main: Press any button to get started !
      button_left: " "
      button_center: " "
      button_right: " "
    action:
      enter:
        camera:
          reset: yes
      button_left:
        goto: filter_normal
      button_center:
        goto: filter_normal
      button_right:
        goto: filter_normal

  filter_normal:
    caption:
      main: Normal
      button_left: Black & White
      button_center: OK
      button_right: Sepia
    action:
      enter:
        camera:
          filter: normal
      button_left:
        goto: filter_blackandwhite
      button_center:
        goto: pre_photo
      button_right:
        goto: filter_sepia

  filter_blackandwhite:
    caption:
      main: Black and white
      button_left: Sepia
      button_center: OK
      button_right: Normal
    action:
      enter:
        camera:
          filter: hatch
      button_left:
        goto: filter_sepia
      button_center:
        goto: pre_photo
      button_right:
        goto: filter_normal

  filter_sepia:
    caption:
      main: Sepia
      button_left: Normal
      button_center: OK
      button_right: Black and White
    action:
      enter:
        camera:
          filter: solarize
      button_left:
        goto: filter_normal
      button_center:
        goto: pre_photo
      button_right:
        goto: filter_blackandwhite

  pre_photo:
    caption:
      main: '{time_left:d}'
      button_left: ""
      button_center: ""
      button_right: ""
    action:
      elapsed:
        time: 5
        goto: photo_1

  photo_1:
    caption:
      main: '{time_left:d}'
      button_left: ""
      button_center: ""
      button_right: ""
    action:
      enter:
        camera:
          capture: photo_{timestamp}.jpg
      elapsed:
        time: 3
        goto: photo_2

  photo_2:
    caption:
      main: '{time_left:d}'
      button_left: ""
      button_center: ""
      button_right: ""
    action:
      enter:
        camera:
          capture: photo_{timestamp}.jpg
      elapsed:
        time: 3
        goto: photo_3

  photo_3:
    caption:
      main: '{time_left:d}'
      button_left: ""
      button_center: ""
      button_right: ""
    action:
      enter:
        camera:
          capture: photo_{timestamp}.jpg
      elapsed:
        time: 3
        goto: photo_4

  photo_4:
    caption:
      main: 'Assembling...' # TODO UGLY visual hack, this file should allow more flexibility (remove elapsed ?)
      button_left: ""
      button_center: ""
      button_right: ""
    action:
      enter:
        camera:
          capture: photo_{timestamp}.jpg
      elapsed:
        time: 3 # give camera time to capture anyway
        goto: assemble
        show_progress: no

  assemble:
    caption:
      main: 'Assembling...'
      button_left: ""
      button_center: ""
      button_right: ""
    action:
      enter:
        assemble: yes
      elapsed:
        time: 1
        goto: idle
        show_progress: no
